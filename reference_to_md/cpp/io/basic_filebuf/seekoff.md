[C++](../../../cpp.html "cpp")

[Compiler support](../../compiler_support.html "cpp/compiler support")  
---  
[Freestanding and hosted](../../freestanding.html "cpp/freestanding")  
[Language](../../language.html "cpp/language")  
[Standard library](../../standard_library.html "cpp/standard library")  
[Standard library headers](../../headers.html "cpp/header")  
[Named requirements](../../iterator/concepts.html "cpp/named req")  
[Feature test macros](../../experimental/feature_test.html "cpp/feature test") (C++20)  
[Language support library](../../utility.html#Language_support "cpp/utility")  
[Concepts library](../../concepts.html "cpp/concepts") (C++20)  
[Diagnostics library](../../error.html "cpp/error")  
[Memory management library](../../memory.html "cpp/memory")  
[Metaprogramming library](../../meta.html "cpp/meta") (C++11)  
[General utilities library](../../utility.html "cpp/utility")  
[Containers library](../../container.html "cpp/container")  
[Iterators library](../../iterator.html "cpp/iterator")  
[Ranges library](../../ranges.html "cpp/ranges") (C++20)  
[Algorithms library](../../algorithm.html "cpp/algorithm")  
[Strings library](../../string.html "cpp/string")  
[Text processing library](../../text.html "cpp/text")  
[Numerics library](../../numeric.html "cpp/numeric")  
[Date and time library](../../chrono.html "cpp/chrono")  
[Input/output library](../../io.html "cpp/io")  
[Filesystem library](../../filesystem.html "cpp/filesystem") (C++17)  
[Concurrency support library](../../atomic.html "cpp/thread") (C++11)  
[Execution control library](../../experimental/execution.html "cpp/execution") (C++26)  
[Technical specifications](../../experimental.html "cpp/experimental")  
[Symbols index](../../symbol_index.html "cpp/symbol index")  
[External libraries](../../links/libs.html "cpp/links/libs")  
  
[[edit]](https://en.cppreference.com/mwiki/index.php?title=Template:cpp/navbar_content&action=edit)

[Input/output library](../../io.html "cpp/io")

[I/O manipulators](../manip.html "cpp/io/manip")  
---  
[Print functions](../../io.html#Print_functions_.28since_C.2B.2B23.29 "cpp/io") (C++23)  
[C-style I/O](../c.html "cpp/io/c")  
Buffers  
[basic_streambuf](../basic_streambuf.html "cpp/io/basic streambuf")  
[basic_filebuf](../basic_filebuf.html "cpp/io/basic filebuf")  
[basic_stringbuf](../basic_stringbuf.html "cpp/io/basic stringbuf")  
[basic_spanbuf](../basic_spanbuf.html "cpp/io/basic spanbuf")(C++23)  
[strstreambuf](../strstreambuf.html "cpp/io/strstreambuf")(C++98/26*)  
[basic_syncbuf](../basic_syncbuf.html "cpp/io/basic syncbuf")(C++20)  
Streams  
Abstractions  
[ios_base](../ios_base.html "cpp/io/ios base")  
[basic_ios](../basic_ios.html "cpp/io/basic ios")  
[basic_istream](../basic_istream.html "cpp/io/basic istream")  
[basic_ostream](../basic_ostream.html "cpp/io/basic ostream")  
[basic_iostream](../basic_iostream.html "cpp/io/basic iostream")  
File I/O  
[basic_ifstream](../basic_ifstream.html "cpp/io/basic ifstream")  
[basic_ofstream](../basic_ofstream.html "cpp/io/basic ofstream")  
[basic_fstream](../basic_fstream.html "cpp/io/basic fstream")  
String I/O  
[basic_istringstream](../basic_istringstream.html "cpp/io/basic istringstream")  
[basic_ostringstream](../basic_ostringstream.html "cpp/io/basic ostringstream")  
[basic_stringstream](../basic_stringstream.html "cpp/io/basic stringstream")  
Array I/O  
[basic_ispanstream](../basic_ispanstream.html "cpp/io/basic ispanstream")(C++23)  
[basic_ospanstream](../basic_ospanstream.html "cpp/io/basic ospanstream")(C++23)  
[basic_spanstream](../basic_spanstream.html "cpp/io/basic spanstream")(C++23)  
[istrstream](../istrstream.html "cpp/io/istrstream")(C++98/26*)  
[ostrstream](../ostrstream.html "cpp/io/ostrstream")(C++98/26*)  
[strstream](../strstream.html "cpp/io/strstream")(C++98/26*)  
Synchronized Output  
[basic_osyncstream](../basic_osyncstream.html "cpp/io/basic osyncstream")(C++20)  
Types  
[streamoff](../streamoff.html "cpp/io/streamoff")  
[streamsize](../streamsize.html "cpp/io/streamsize")  
[fpos](../fpos.html "cpp/io/fpos")  
Error category interface  
[iostream_category](../iostream_category.html "cpp/io/iostream category")(C++11)  
[io_errc](../io_errc.html "cpp/io/io errc")(C++11)  
  
[[edit]](https://en.cppreference.com/mwiki/index.php?title=Template:cpp/io/navbar_content&action=edit)

[`std::basic_filebuf`](../basic_filebuf.html "cpp/io/basic filebuf")

Public member functions  
---  
[basic_filebuf::basic_filebuf](basic_filebuf.html "cpp/io/basic filebuf/basic filebuf")  
[basic_filebuf::~basic_filebuf](~basic_filebuf.html "cpp/io/basic filebuf/~basic filebuf")  
[basic_filebuf::operator=](operator=.html "cpp/io/basic filebuf/operator=")(C++11)  
[basic_filebuf::swap](swap.html "cpp/io/basic filebuf/swap")(C++11)  
[basic_filebuf::native_handle](native_handle.html "cpp/io/basic filebuf/native handle")(C++26)  
[basic_filebuf::is_open](is_open.html "cpp/io/basic filebuf/is open")  
[basic_filebuf::open](open.html "cpp/io/basic filebuf/open")  
[basic_filebuf::close](close.html "cpp/io/basic filebuf/close")  
Protected member functions  
[basic_filebuf::showmanyc](showmanyc.html "cpp/io/basic filebuf/showmanyc")  
[basic_filebuf::underflow](underflow.html "cpp/io/basic filebuf/underflow")  
[basic_filebuf::uflow](uflow.html "cpp/io/basic filebuf/uflow")  
[basic_filebuf::pbackfail](pbackfail.html "cpp/io/basic filebuf/pbackfail")  
[basic_filebuf::overflow](overflow.html "cpp/io/basic filebuf/overflow")  
[basic_filebuf::setbuf](setbuf.html "cpp/io/basic filebuf/setbuf")  
**basic_filebuf::seekoff**  
[basic_filebuf::seekpos](seekpos.html "cpp/io/basic filebuf/seekpos")  
[basic_filebuf::sync](sync.html "cpp/io/basic filebuf/sync")  
[basic_filebuf::imbue](imbue.html "cpp/io/basic filebuf/imbue")  
Non-member functions  
[swap(std::basic_filebuf)](swap2.html "cpp/io/basic filebuf/swap2")(C++11)  
  
[[edit]](https://en.cppreference.com/mwiki/index.php?title=Template:cpp/io/basic_filebuf/navbar_content&action=edit)

protected:  
virtual pos_type seekoff( off_type off,  
[std::ios_base::seekdir](../ios_base/seekdir.html) dir,  
[std::ios_base::openmode](../ios_base/openmode.html) which = [std::ios_base::in](../ios_base/openmode.html) | [std::ios_base::out](../ios_base/openmode.html) ); |  |   
---|---|---  
| |   
  
Repositions the file pointer, if possible, to the position that corresponds to exactly off characters from beginning, end, or current position of the file (depending on the value of dir). 

If the associated file is not open (is_open() == false), fails immediately. 

If the multibyte character encoding is state-dependent ([`codecvt::encoding()`](../../locale/codecvt/encoding.html "cpp/locale/codecvt/encoding") returned -1) or variable-length (`codecvt::encoding()` returned ‚Äã0‚Äã) and the offset off is not ‚Äã0‚Äã, fails immediately: this function cannot determine the number of bytes that correspond to off characters. 

If dir is not [std::basic_ios::cur](../ios_base/seekdir.html "cpp/io/ios base/seekdir") or the offset off is not ‚Äã0‚Äã, and the most recent operation done on this filebuf object was output (that is, either the put buffer is not empty, or the most recently called function was [overflow()](../basic_streambuf/overflow.html "cpp/io/basic streambuf/overflow")), then calls std::codecvt::unshift to determine the unshift sequence necessary, and writes that sequence to the file by calling [overflow()](../basic_streambuf/overflow.html "cpp/io/basic streambuf/overflow"). 

Then converts the argument dir to a value whence of type int as follows: 

value of dir |  value of whence  
---|---  
std::basic_ios::beg |  [SEEK_SET](../c.html "cpp/io/c")  
std::basic_ios::end |  [SEEK_END](../c.html "cpp/io/c")  
std::basic_ios::cur |  [SEEK_CUR](../c.html "cpp/io/c")  
  
Then, if the character encoding is fixed-width (`codecvt::encoding()` returns some positive number width), moves the file pointer as if by [std::fseek](../c/fseek.html)(file, width*off, whence). 

Otherwise, moves the file pointer as if by [std::fseek](../c/fseek.html)(file, 0, whence). 

The `openmode` argument, required by the base class function signature, is usually ignored, because `std::basic_filebuf` maintains only one file position. 

## Contents

  * [1 Parameters](seekoff.html#Parameters)
  * [2 Return value](seekoff.html#Return_value)
  * [3 Notes](seekoff.html#Notes)
  * [4 Example](seekoff.html#Example)
  * [5 Defect reports](seekoff.html#Defect_reports)
  * [6 See also](seekoff.html#See_also)

  
---  
  
### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/io/basic_filebuf/seekoff&action=edit&section=1 "Edit section: Parameters")] Parameters

off  |  \-  |  relative position to set the position indicator to   
---|---|---  
dir  |  \-  |  defines base position to apply the relative offset to. It can be one of the following constants:  |  Constant  |  Explanation   
---|---  
[`beg`](../ios_base/seekdir.html "cpp/io/ios base/seekdir") |  the beginning of a stream   
[`end`](../ios_base/seekdir.html "cpp/io/ios base/seekdir") |  the ending of a stream   
[`cur`](../ios_base/seekdir.html "cpp/io/ios base/seekdir") |  the current position of stream position indicator   
which  |  \-  |  defines which of the input and/or output sequences to affect. It can be one or a combination of the following constants:  |  Constant  |  Explanation   
---|---  
[`in`](../ios_base/openmode.html "cpp/io/ios base/openmode") |  affect the input sequence   
[`out`](../ios_base/openmode.html "cpp/io/ios base/openmode") |  affect the output sequence   
  
### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/io/basic_filebuf/seekoff&action=edit&section=2 "Edit section: Return value")] Return value

A newly constructed object of type pos_type which stores the resulting file position, or pos_type(off_type(-1)) on failure. 

### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/io/basic_filebuf/seekoff&action=edit&section=3 "Edit section: Notes")] Notes

`seekoff()` is called by std::basic_streambuf::pubseekoff, which is called by std::basic_istream::seekg, std::basic_ostream::seekp, std::basic_istream::tellg, and std::basic_ostream::tellp. 

### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/io/basic_filebuf/seekoff&action=edit&section=4 "Edit section: Example")] Example

Run this code
    
    
    #include <fstream>
    #include <iostream>
    #include <locale>
    ¬†
    template<typename CharT>
    int get_encoding(const [std::basic_istream](../basic_istream.html)<CharT>& stream)
    {
        using Facet = [std::codecvt](../../locale/codecvt.html)<CharT, char, [std::mbstate_t](../../string/multibyte/mbstate_t.html)>;
        return [std::use_facet](../../locale/use_facet.html)<Facet>(stream.getloc()).encoding();
    }
    ¬†
    int main()
    {
        // prepare a 10-byte file holding 4 characters ("z√üÊ∞¥ùÑã") in UTF-8
        [std::ofstream](../basic_ofstream.html)("text.txt") << "\x7a\xc3\x9f\xe6\xb0\xb4\xf0\x9d\x84\x8b";
    ¬†
        // open using a non-converting encoding
        [std::ifstream](../basic_ifstream.html) f1("text.txt");
        [std::cout](../cout.html) << "f1's locale's encoding() returns "
                  << get_encoding(f1) << '\n'
                  << "pubseekoff(3, beg) returns "
                  << f1.rdbuf()->pubseekoff(3, [std::ios_base::beg](../ios_base/seekdir.html)) << '\n'
                  << "pubseekoff(0, end) returns "
                  << f1.rdbuf()->pubseekoff(0, [std::ios_base::end](../ios_base/seekdir.html)) << '\n';
    ¬†
        // open using UTF-8
        [std::wifstream](../basic_ifstream.html) f2("text.txt");
        f2.imbue([std::locale](../../locale/locale.html)("en_US.UTF-8"));
        [std::cout](../cout.html) << "f2's locale's encoding() returns "
                  << get_encoding(f2) << '\n'
                  << "pubseekoff(3, beg) returns "
                  << f2.rdbuf()->pubseekoff(3, [std::ios_base::beg](../ios_base/seekdir.html)) << '\n'
                  << "pubseekoff(0, end) returns "
                  << f2.rdbuf()->pubseekoff(0, [std::ios_base::end](../ios_base/seekdir.html)) << '\n';
    }

Output: 
    
    
    f1's locale's encoding() returns 1
    pubseekoff(3, beg) returns 3
    pubseekoff(0, end) returns 10
    f2's locale's encoding() returns 0
    pubseekoff(3, beg) returns -1
    pubseekoff(0, end) returns 10

### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/io/basic_filebuf/seekoff&action=edit&section=5 "Edit section: Defect reports")] Defect reports

The following behavior-changing defect reports were applied retroactively to previously published C++ standards. 

DR  | Applied to  | Behavior as published  | Correct behavior   
---|---|---|---  
[LWG 55](https://cplusplus.github.io/LWG/issue55) | C++98  | `seekoff` returned an undefined  
invalid stream position on failure  | pos_type(off_type(-1))  
is returned on failure   
  
### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/io/basic_filebuf/seekoff&action=edit&section=6 "Edit section: See also")] See also

[ pubseekoff](../basic_streambuf/pubseekoff.html "cpp/io/basic streambuf/pubseekoff") |  invokes seekoff()   
(public member function of `std::basic_streambuf<CharT,Traits>`) [[edit]](https://en.cppreference.com/mwiki/index.php?title=Template:cpp/io/basic_streambuf/dsc_pubseekoff&action=edit)  
---|---  
[ seekpos](seekpos.html "cpp/io/basic filebuf/seekpos")[virtual] |  repositions the file position, using absolute addressing   
(virtual protected member function) [[edit]](https://en.cppreference.com/mwiki/index.php?title=Template:cpp/io/basic_filebuf/dsc_seekpos&action=edit)  
[ fseek](../c/fseek.html "cpp/io/c/fseek") |  moves the file position indicator to a specific location in a file   
(function) [[edit]](https://en.cppreference.com/mwiki/index.php?title=Template:cpp/io/c/dsc_fseek&action=edit)
