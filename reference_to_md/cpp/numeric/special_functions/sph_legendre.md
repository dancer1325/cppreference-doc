[C++](../../../cpp.html "cpp")

[Compiler support](../../compiler_support.html "cpp/compiler support")  
---  
[Freestanding and hosted](../../freestanding.html "cpp/freestanding")  
[Language](../../language.html "cpp/language")  
[Standard library](../../standard_library.html "cpp/standard library")  
[Standard library headers](../../headers.html "cpp/header")  
[Named requirements](../../iterator/concepts.html "cpp/named req")  
[Feature test macros](../../experimental/feature_test.html "cpp/feature test") (C++20)  
[Language support library](../../utility.html#Language_support "cpp/utility")  
[Concepts library](../../concepts.html "cpp/concepts") (C++20)  
[Diagnostics library](../../error.html "cpp/error")  
[Memory management library](../../memory.html "cpp/memory")  
[Metaprogramming library](../../meta.html "cpp/meta") (C++11)  
[General utilities library](../../utility.html "cpp/utility")  
[Containers library](../../container.html "cpp/container")  
[Iterators library](../../iterator.html "cpp/iterator")  
[Ranges library](../../ranges.html "cpp/ranges") (C++20)  
[Algorithms library](../../algorithm.html "cpp/algorithm")  
[Strings library](../../string.html "cpp/string")  
[Text processing library](../../text.html "cpp/text")  
[Numerics library](../../numeric.html "cpp/numeric")  
[Date and time library](../../chrono.html "cpp/chrono")  
[Input/output library](../../io.html "cpp/io")  
[Filesystem library](../../filesystem.html "cpp/filesystem") (C++17)  
[Concurrency support library](../../atomic.html "cpp/thread") (C++11)  
[Execution control library](../../experimental/execution.html "cpp/execution") (C++26)  
[Technical specifications](../../experimental.html "cpp/experimental")  
[Symbols index](../../symbol_index.html "cpp/symbol index")  
[External libraries](../../links/libs.html "cpp/links/libs")  
  
[[edit]](https://en.cppreference.com/mwiki/index.php?title=Template:cpp/navbar_content&action=edit)

[Numerics library](../../numeric.html "cpp/numeric")

[Common mathematical functions](../math.html "cpp/numeric/math")  
---  
[Mathematical special functions](../special_math.html "cpp/numeric/special functions") (C++17)  
[Mathematical constants](../constants.html "cpp/numeric/constants") (C++20)  
[Basic linear algebra algorithms](../linalg.html "cpp/numeric/linalg") (C++26)  
[Data-parallel types (SIMD)](../simd.html "cpp/numeric/simd") (C++26)  
[Floating-point environment](../fenv.html "cpp/numeric/fenv") (C++11)  
[Complex numbers](../complex.html "cpp/numeric/complex")  
[Numeric array (`valarray`)](../valarray.html "cpp/numeric/valarray")  
[Pseudo-random number generation](../random.html "cpp/numeric/random")  
[Bit manipulation](../../utility/bit.html "cpp/utility/bit") (C++20)  
[Saturation arithmetic](../../numeric.html#Saturation_arithmetic "cpp/numeric") (C++26)  
[Factor operations](../../numeric.html#Factor_operations "cpp/numeric")  
| [gcd](../gcd.html "cpp/numeric/gcd")(C++17)  
---  
  
| [lcm](../lcm.html "cpp/numeric/lcm")(C++17)  
---  
  
[Interpolations](../../numeric.html#Interpolation_operations "cpp/numeric")  
| [midpoint](../midpoint.html "cpp/numeric/midpoint")(C++20)  
---  
  
| [lerp](../lerp.html "cpp/numeric/lerp")(C++20)  
---  
  
[Generic numeric operations](../../numeric.html#Numeric_operations "cpp/numeric")  
| [iota](../../algorithm/iota.html "cpp/algorithm/iota")(C++11)  
---  
[ranges::iota](../../algorithm/ranges/iota.html "cpp/algorithm/ranges/iota")(C++23)  
[accumulate](../../algorithm/accumulate.html "cpp/algorithm/accumulate")  
[inner_product](../../algorithm/inner_product.html "cpp/algorithm/inner product")  
[adjacent_difference](../../algorithm/adjacent_difference.html "cpp/algorithm/adjacent difference")` `  
[partial_sum](../../algorithm/partial_sum.html "cpp/algorithm/partial sum")  
  
| [reduce](../../algorithm/reduce.html "cpp/algorithm/reduce")(C++17)  
---  
[transform_reduce](../../algorithm/transform_reduce.html "cpp/algorithm/transform reduce")(C++17)  
[inclusive_scan](../../algorithm/inclusive_scan.html "cpp/algorithm/inclusive scan")(C++17)  
[exclusive_scan](../../algorithm/exclusive_scan.html "cpp/algorithm/exclusive scan")(C++17)  
[transform_inclusive_scan](../../algorithm/transform_inclusive_scan.html "cpp/algorithm/transform inclusive scan")(C++17)  
[transform_exclusive_scan](../../algorithm/transform_exclusive_scan.html "cpp/algorithm/transform exclusive scan")(C++17)  
  
[C-style checked integer arithmetic](../../numeric.html#Checked_integer_arithmetic "cpp/numeric")  
| [ckd_add](../ckd_add.html "cpp/numeric/ckd add")(C++26)  
---  
[ckd_sub](../ckd_sub.html "cpp/numeric/ckd sub")(C++26)  
  
| [ckd_mul](../ckd_mul.html "cpp/numeric/ckd mul")(C++26)  
---  
  
  
  
[[edit]](https://en.cppreference.com/mwiki/index.php?title=Template:cpp/numeric/navbar_content&action=edit)

[Mathematical special functions](../special_math.html "cpp/numeric/special functions")

| [assoc_laguerreassoc_laguerrefassoc_laguerrel ](assoc_laguerre.html "cpp/numeric/special functions/assoc laguerre")  
---  
[assoc_legendreassoc_legendrefassoc_legendrel](assoc_legendre.html "cpp/numeric/special functions/assoc legendre")  
[betabetafbetal](beta.html "cpp/numeric/special functions/beta")  
[comp_ellint_1comp_ellint_1fcomp_ellint_1l](comp_ellint_1.html "cpp/numeric/special functions/comp ellint 1")  
[comp_ellint_2comp_ellint_2fcomp_ellint_2l](comp_ellint_2.html "cpp/numeric/special functions/comp ellint 2")  
[comp_ellint_3comp_ellint_3fcomp_ellint_3l](comp_ellint_3.html "cpp/numeric/special functions/comp ellint 3")  
[cyl_bessel_icyl_bessel_ifcyl_bessel_il](cyl_bessel_i.html "cpp/numeric/special functions/cyl bessel i")  
  
| [cyl_bessel_jcyl_bessel_jfcyl_bessel_jl ](cyl_bessel_j.html "cpp/numeric/special functions/cyl bessel j")  
---  
[cyl_bessel_kcyl_bessel_kfcyl_bessel_kl](cyl_bessel_k.html "cpp/numeric/special functions/cyl bessel k")  
[cyl_neumanncyl_neumannfcyl_neumannl](cyl_neumann.html "cpp/numeric/special functions/cyl neumann")  
[ellint_1ellint_1fellint_1l](ellint_1.html "cpp/numeric/special functions/ellint 1")  
[ellint_2ellint_2fellint_2l](ellint_2.html "cpp/numeric/special functions/ellint 2")  
[ellint_3ellint_3fellint_3l](ellint_3.html "cpp/numeric/special functions/ellint 3")  
[expintexpintfexpintl](expint.html "cpp/numeric/special functions/expint")  
  
| [hermitehermitefhermitel](hermite.html "cpp/numeric/special functions/hermite")  
---  
[laguerrelaguerreflaguerrel](laguerre.html "cpp/numeric/special functions/laguerre")  
[legendrelegendreflegendrel](legendre.html "cpp/numeric/special functions/legendre")  
[riemann_zetariemann_zetafriemann_zetal](riemann_zeta.html "cpp/numeric/special functions/riemann zeta")  
[sph_besselsph_besselfsph_bessell](sph_bessel.html "cpp/numeric/special functions/sph bessel")  
**sph_legendre sph_legendrefsph_legendrel**  
[sph_neumannsph_neumannfsph_neumannl](sph_neumann.html "cpp/numeric/special functions/sph neumann")  
  
[[edit]](https://en.cppreference.com/mwiki/index.php?title=Template:cpp/numeric/special_functions/navbar_content&action=edit)

Defined in header `[<cmath>](../../header/cmath.html "cpp/header/cmath")` |  |   
---|---|---  
| (1) |   
float sph_legendre ( unsigned l, unsigned m, float theta );  
double sph_legendre ( unsigned l, unsigned m, double theta );  
long double sph_legendre ( unsigned l, unsigned m, long double theta ); |  | (since C++17)   
(until C++23)  
/* floating-point-type */ sph_legendre( unsigned l, unsigned m,  
/* floating-point-type */ theta ); |  |  (since C++23)  
float sph_legendref( unsigned l, unsigned m, float theta ); |  (2)  |  (since C++17)  
long double sph_legendrel( unsigned l, unsigned m, long double theta ); |  (3)  |  (since C++17)  
[Additional overloads](sph_legendre.html#Notes) |  |   
Defined in header `[<cmath>](../../header/cmath.html "cpp/header/cmath")` |  |   
template< class Integer >  
double sph_legendre ( unsigned l, unsigned m, Integer theta ); |  (A)  |  (since C++17)  
| |   
  
1-3) Computes the [spherical associated Legendre function](https://en.wikipedia.org/wiki/Spherical_harmonics#Orthogonality_and_normalization "enwiki:Spherical harmonics") of degree l, order m, and polar angle theta. The library provides overloads of `std::sph_legendre` for all cv-unqualified floating-point types as the type of the parameter theta.(since C++23)

A) Additional overloads are provided for all integer types, which are treated as double.

## Contents

  * [1 Parameters](sph_legendre.html#Parameters)
  * [2 Return value](sph_legendre.html#Return_value)
  * [3 Error handling](sph_legendre.html#Error_handling)
  * [4 Notes](sph_legendre.html#Notes)
  * [5 Example](sph_legendre.html#Example)
  * [6 See also](sph_legendre.html#See_also)
  * [7 External links](sph_legendre.html#External_links)

  
---  
  
### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/numeric/special_functions/sph_legendre&action=edit&section=1 "Edit section: Parameters")] Parameters

l  |  \-  |  degree   
---|---|---  
m  |  \-  |  order   
theta  |  \-  |  polar angle, measured in radians   
  
### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/numeric/special_functions/sph_legendre&action=edit&section=2 "Edit section: Return value")] Return value

If no errors occur, returns the value of the spherical associated Legendre function (that is, spherical harmonic with ϕ = 0) of l, m, and theta, where the spherical harmonic function is defined as Ym  
l(theta,ϕ) = (-1)m  
[(2l+1)(l-m)!  
---  
4π(l+m)!  
]1/2  
Pm  
l(cos(theta))eimϕ  
where Pm  
l(x) is [std::assoc_legendre](assoc_legendre.html)(l, m, x)) and |m|≤l. 

Note that the [Condon-Shortley phase term ](https://mathworld.wolfram.com/Condon-ShortleyPhase.html) (-1)m  
is included in this definition because it is omitted from the definition of Pm  
l in [std::assoc_legendre](assoc_legendre.html "cpp/numeric/special functions/assoc legendre"). 

### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/numeric/special_functions/sph_legendre&action=edit&section=3 "Edit section: Error handling")] Error handling

Errors may be reported as specified in [math_errhandling](../math/math_errhandling.html "cpp/numeric/math/math errhandling"). 

  * If the argument is NaN, NaN is returned and domain error is not reported. 
  * If l≥128, the behavior is implementation-defined. 



### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/numeric/special_functions/sph_legendre&action=edit&section=4 "Edit section: Notes")] Notes

Implementations that do not support C++17, but support [ISO 29124:2010](../../experimental/special_math.html "cpp/experimental/special math"), provide this function if `__STDCPP_MATH_SPEC_FUNCS__` is defined by the implementation to a value at least 201003L and if the user defines `__STDCPP_WANT_MATH_SPEC_FUNCS__` before including any standard library headers. 

Implementations that do not support ISO 29124:2010 but support TR 19768:2007 (TR1), provide this function in the header `tr1/cmath` and namespace `std::tr1`. 

An implementation of the spherical harmonic function is available in [boost.math](https://www.boost.org/doc/libs/release/libs/math/doc/html/math_toolkit/sf_poly/sph_harm.html), and it reduces to this function when called with the parameter phi set to zero. 

The additional overloads are not required to be provided exactly as (A). They only need to be sufficient to ensure that for their argument num of integer type, std::sph_legendre(int_num1, int_num2, num) has the same effect as std::sph_legendre(int_num1, int_num2, static_cast<double>(num)). 

### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/numeric/special_functions/sph_legendre&action=edit&section=5 "Edit section: Example")] Example

Run this code
    
    
    #include <cmath>
    #include <iostream>
    #include <numbers>
     
    int main()
    {
        // spot check for l=3, m=0
        double x = 1.2345;
        [std::cout](../../io/cout.html) << "Y_3^0(" << x << ") = " << std::sph_legendre(3, 0, x) << '\n';
     
        // exact solution
        [std::cout](../../io/cout.html) << "exact solution = "
                  << 0.25 * [std::sqrt](../math/sqrt.html)(7 / [std::numbers::pi](../constants.html))
                      * (5 * [std::pow](../math/pow.html)([std::cos](../math/cos.html)(x), 3) - 3 * [std::cos](../math/cos.html)(x))
                  << '\n';
    }

Output: 
    
    
    Y_3^0(1.2345) = -0.302387
    exact solution = -0.302387

### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/numeric/special_functions/sph_legendre&action=edit&section=6 "Edit section: See also")] See also

[ assoc_legendreassoc_legendrefassoc_legendrel](assoc_legendre.html "cpp/numeric/special functions/assoc legendre")(C++17)(C++17)(C++17) |  associated Legendre polynomials   
(function) [[edit]](https://en.cppreference.com/mwiki/index.php?title=Template:cpp/numeric/special_functions/dsc_assoc_legendre&action=edit)  
---|---  
  
### [[edit](https://en.cppreference.com/mwiki/index.php?title=cpp/numeric/special_functions/sph_legendre&action=edit&section=7 "Edit section: External links")] External links

[Weisstein, Eric W. "Spherical Harmonic."](https://mathworld.wolfram.com/SphericalHarmonic.html) From MathWorld — A Wolfram Web Resource.   
---
